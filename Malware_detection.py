"""
    
Malware Detection Model Using RandomForest Algorithm

"""

#Import the required modules
import os
import pandas
import numpy
import sklearn.ensemble as ek
import joblib
from sklearn.metrics import confusion_matrix
from sklearn.model_selection import train_test_split

# Split the data to train and test
dataset = pandas.read_csv('data.csv',sep='|', low_memory=False)
dataset.groupby(dataset['legitimate']).size()
X = dataset.drop(['Name','md5','legitimate'],axis=1).values
y = dataset['legitimate'].values
X_train, X_test, y_train, y_test = train_test_split(X, y ,test_size=0.2)

# Train the Model
clf = ek.RandomForestClassifier(n_estimators=50)
clf.fit(X_train,y_train)
score = clf.score(X_test,y_test)

# Saving the Model
joblib.dump(clf,'Model/classifier.pkl') # where u want to save the model folder_path/Model_name.pkl
print("Model is created Sucessfully")